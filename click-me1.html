<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ðŸŒ¸ðŸ’¥ Will You Be With Me Again?</title>
  <style>
    body,html{margin:0;height:100%;overflow:hidden;background:#fff6fb;display:flex;align-items:center;justify-content:center;}
    #preflower{animation:pulse 2s infinite ease-in-out;cursor:pointer}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}

    #main{display:none;position:relative;width:100%;height:100%;overflow:hidden;background: radial-gradient(1200px 800px at 20% 10%, #f7fff1, transparent 70%),radial-gradient(1000px 700px at 80% 0%, #e6f7ff, transparent 70%),radial-gradient(1200px 800px at 50% 100%, #fff6fb, transparent 70%),linear-gradient(135deg,#fff,#fff);} 

    .card{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;color:#40384a}
    h1{font-size:clamp(28px,5vw,46px);margin:10px 0 6px}
    .sub{font-size:clamp(14px,2.8vw,18px);opacity:.8;margin-top:6px}
    .typewriter{border-right:3px solid #ff6b9c;white-space:nowrap;overflow:hidden;animation:caret 1s step-end infinite;}
    @keyframes caret{50%{border-color:transparent}}
    #fw{position:fixed;inset:0;z-index:0}
    .heart{position:fixed;font-size:20px;animation:rise 2.2s ease forwards;pointer-events:none}
    @keyframes rise{from{transform:translateY(0) scale(.8);opacity:1}to{transform:translateY(-140px) scale(1.6);opacity:0}}
  </style>
</head>
<body>

  <!-- Preloader flower -->
  <div id="preflower">
    <svg viewBox="0 0 100 100" width="120" height="120">
      <defs>
        <radialGradient id="g1" cx="50%" cy="50%" r="55%">
          <stop offset="0%" stop-color="#fff"/>
          <stop offset="60%" stop-color="#ffd6e8"/>
          <stop offset="100%" stop-color="#ff9fc1"/>
        </radialGradient>
      </defs>
      <g transform="translate(50,50)">
        <ellipse rx="14" ry="28" transform="rotate(0) translate(0,-22)" fill="url(#g1)"/>
        <ellipse rx="14" ry="28" transform="rotate(72) translate(0,-22)" fill="url(#g1)"/>
        <ellipse rx="14" ry="28" transform="rotate(144) translate(0,-22)" fill="url(#g1)"/>
        <ellipse rx="14" ry="28" transform="rotate(216) translate(0,-22)" fill="url(#g1)"/>
        <ellipse rx="14" ry="28" transform="rotate(288) translate(0,-22)" fill="url(#g1)"/>
        <circle r="10" fill="#ffe277" stroke="#f6c23e" stroke-width="2"/>
      </g>
    </svg>
  </div>

  <!-- Main page hidden initially -->
  <div id="main">
    <canvas id="fw"></canvas>
    <section class="card">
      <h1><span id="tw" class="typewriter"></span></h1>
      <p class="sub">From <strong id="from-name">Me</strong> to <strong id="to-name">You</strong></p>
    </section>
  </div>

  <script>
    const preflower = document.getElementById('preflower');
    const main = document.getElementById('main');
    const fw = document.getElementById('fw');
    const ctx = fw.getContext('2d');
    let W,H,dpr;
    function resize(){dpr=Math.max(1,Math.min(2,window.devicePixelRatio||1));W=fw.width=Math.floor(innerWidth*dpr);H=fw.height=Math.floor(innerHeight*dpr);fw.style.width=innerWidth+'px';fw.style.height=innerHeight+'px';}
    addEventListener('resize',resize);resize();

    const particles=new Set();
    function fire(x,y){const count=80;const speed=2.4*dpr;for(let i=0;i<count;i++){const a=(i/count)*Math.PI*2+Math.random()*0.1;const v=speed*(0.6+Math.random()*0.9);particles.add({x,y,vx:Math.cos(a)*v,vy:Math.sin(a)*v,life:60+Math.random()*20,r:2+Math.random()*2});}}
    function step(){ctx.clearRect(0,0,W,H);for(const p of Array.from(particles)){p.x+=p.vx;p.y+=p.vy;p.vy+=0.03*dpr;p.vx*=0.99;p.vy*=0.99;p.life-=1;if(p.life<=0||p.y>H+20){particles.delete(p);continue;}ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fillStyle=`hsla(${(p.x+p.y)%360},100%,60%,${Math.max(0,p.life/60)})`;ctx.fill();}requestAnimationFrame(step);}step();

    function typeMessage(text){let i=0;function loop(){document.getElementById('tw').textContent=text.slice(0,i++);if(i<=text.length){setTimeout(loop,70);}else{document.getElementById('tw').style.borderRightColor='transparent';}}loop();}

    preflower.addEventListener('click',()=>{
      // spin animation
      preflower.style.animation='spin 1s forwards';
      preflower.style.display='none';
      main.style.display='block';
      fire(W/2,H/2);
      typeMessage("Will you be with me again?");
    });

    const url=new URL(location.href);
    if(url.searchParams.get('from'))document.getElementById('from-name').textContent=url.searchParams.get('from');
    if(url.searchParams.get('to'))document.getElementById('to-name').textContent=url.searchParams.get('to');

    const style=document.createElement('style');style.textContent=`@keyframes spin{to{transform:rotate(720deg) scale(0)}}`;document.head.appendChild(style);
  </script>
</body>
</html>
